From 5df6d82f20848215818f13a0c6074d77a7b7b7f5 Mon Sep 17 00:00:00 2001
From: Anton Kikin <a.kikin@tano-systems.com>
Date: Tue, 11 Sep 2018 16:38:52 +0300
Subject: [PATCH 1/3] luci-app-statistics: add image_height option to config file

Signed-off-by: Anton Kikin <a.kikin@tano-systems.com>
---
 luasrc/statistics/rrdtool.lua   | 4 +++-
 root/etc/config/luci_statistics | 3 ++-
 2 files changed, 5 insertions(+), 2 deletions(-)

diff --git a/luasrc/statistics/rrdtool.lua b/luasrc/statistics/rrdtool.lua
index 47e1696ec..683eb57f2 100644
--- a/luasrc/statistics/rrdtool.lua
+++ b/luasrc/statistics/rrdtool.lua
@@ -28,6 +28,7 @@ function Graph.__init__( self, timespan, opts )
 	opts.rramax    = opts.rramax    or ( sections.collectd_rrdtool.RRAMax == "1" )
 	opts.host      = opts.host      or sections.collectd.Hostname        or luci.sys.hostname()
 	opts.width     = opts.width     or sections.rrdtool.image_width      or 400
+	opts.height    = opts.height    or sections.rrdtool.image_height     or 200
 	opts.rrdpath   = opts.rrdpath   or sections.collectd_rrdtool.DataDir or "/tmp/rrd"
 	opts.imgpath   = opts.imgpath   or sections.rrdtool.image_path       or "/tmp/rrdimg"
 	opts.rrdpath   = opts.rrdpath:gsub("/$","")
@@ -42,7 +43,8 @@ function Graph.__init__( self, timespan, opts )
 	self.args = {
 		"-a", "PNG",
 		"-s", "NOW-" .. opts.timespan,
-		"-w", opts.width
+		"-w", opts.width,
+		"-h", opts.height
 	}
 
 	-- store options
diff --git a/root/etc/config/luci_statistics b/root/etc/config/luci_statistics
index 8cc918e3d..9ac2c6a54 100644
--- a/root/etc/config/luci_statistics
+++ b/root/etc/config/luci_statistics
@@ -11,7 +11,8 @@ config statistics 'collectd'
 
 config statistics 'rrdtool'
 	option default_timespan '1hour'
-	option image_width '600'
+	option image_width '700'
+	option image_height '200'
 	option image_path '/tmp/rrdimg'
 
 # output plugins
-- 
2.16.2.windows.1

